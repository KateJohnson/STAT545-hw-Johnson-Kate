gapminder %>%
arrange(desc(lifeExp))
gapminder.reordered <- gapminder %>%
arrange(desc(lifeExp))
View(gapminder.reordered)
gapminder.reordered <- gapminder %>%
group_by(continent) %>%
arrange(desc(lifeExp))
View(gapminder.reordered)
gapminder.reordered <- gapminder %>%
group_by(continent) %>%
arrange(desc(lifeExp))
View(gapminder.reordered)
gapminder.reordered <- gapminder %>%
group_by(continent, country) %>%
arrange(desc(lifeExp))
View(gapminder.reordered)
View(gapminder)
View(gapminder.reordered)
gapminder.reordered <- gapminder %>%
group_by(continent, country) %>%
arrange(lifeExp)
View(gapminder.reordered)
gapminder.reordered <- gapminder %>%
group_by(continent, country, year) %>%
arrange(lifeExp)
View(gapminder.reordered)
gapminder.reordered <- gapminder %>%
group_by(continent) %>%
arrange(mean(lifeExp))
gapminder.reordered <- gapminder %>%
group_by(continent, country, year) %>%
arrange(lifeExp)
View(gapminder.reordered)
gapminder.reordered <- gapminder %>%
group_by(continent) %>%
arrange(lifeExp)
View(gapminder.reordered)
View(gapminder)
gapminder.reordered <- gapminder %>%
group_by(continent) %>%
arrange(lifeExp, by.group=TRUE)
gapminder.reordered <- gapminder %>%
group_by(continent) %>%
arrange(lifeExp, by_group=TRUE)
gapminder.reordered <- gapminder %>%
group_by(continent) %>%
arrange(lifeExp, by_group=continent)
View(gapminder.reordered)
gapminder.reordered <- gapminder %>%
group_by(continent) %>%
arrange(lifeExp)
View(gapminder.reordered)
View(gapminder.reordered)
View(gapminder)
View(gapminder.reordered)
write.table(gapminder.reordered, file="/Users/katejohnson/Google Drive/Classes/STAT545.547/STAT545-hw-Johnson-Kate/STAT545-hw-Johnson-Kate_Oct5/hw07-Automating_Pipelines/gapminder.reordered.tsv")
read.table(gapminder.reordered, file="/Users/katejohnson/Google Drive/Classes/STAT545.547/STAT545-hw-Johnson-Kate/STAT545-hw-Johnson-Kate_Oct5/hw07-Automating_Pipelines/gapminder.reordered.tsv")
read.table("/Users/katejohnson/Google Drive/Classes/STAT545.547/STAT545-hw-Johnson-Kate/STAT545-hw-Johnson-Kate_Oct5/hw07-Automating_Pipelines/gapminder.reordered.tsv")
gapminder.reordered <- read.table("/Users/katejohnson/Google Drive/Classes/STAT545.547/STAT545-hw-Johnson-Kate/STAT545-hw-Johnson-Kate_Oct5/hw07-Automating_Pipelines/gapminder.reordered.tsv")
View(gapminder.reordered)
head(gapminder.reordered)
library(broom)
library(broom)
lm(lifeExp ~ year, data=gapminder.reordered)
lm(lifeExp ~ I(year-1952), data=gapminder.reordered)
gap.reordered.nested <- gapminder.reordered %>%
group_by(country) %>%
nest()
View(gap.reordered.nested)
gap.reordered.nested <- gapminder.reordered %>%
group_by(continent, country) %>%
nest()
fit <- lm(lifeExp ~ I(year-offset), data=mydata)
fit <- lm(lifeExp ~ I(year-offset), data=gap.reordered.nested)
lm_fit <- function(mydata, offset=1952) {
fit <- lm(lifeExp ~ I(year-offset), data=mydata)
tidy(fit)
}
lm_fit(gap.reordered.nested)
View(gapminder.reordered)
View(gap.reordered.nested)
map(gap.reordered.nested, lm_fit)
kable(gap.reordered.nested[[1, "data"]])
gap.reordered.nested[[1, "data"]]
gap.reordered.nested <- gapminder.reordered %>%
group_by(continent, country) %>%
select(year, lifeExp) %>%
nest()
gap.reordered.nested <- gapminder.reordered %>%
group_by(continent, country) %>%
select(continent, country, year, lifeExp) %>%
nest()
gap.reordered.nested[[1, "data"]]
View(gap.reordered.nested)
map(gap.reordered.nested$data, lm_fit)
gap.reordered.nested <- gap.reordered.nested %>%
mutate(fit.lm = map(data, lm_fit))
View(gapminder.reordered)
View(gap.reordered.nested)
gap.reordered.nested %>%
mutate(fit.lm = map(data, lm_fit)) %>%
select(continent, country, fit.lm) %>%
unnest(fit.lm)
gap.lifeExp.fits <- gap.reordered.nested %>%
mutate(fit.lm = map(data, lm_fit)) %>%
select(continent, country, fit.lm) %>%
unnest(fit.lm)
View(gap.lifeExp.fits)
gap.lifeExp.fits %>%
filter(estimate <0)
gap.lifeExp.fits %>%
filter(estimate <0)
(gap.lifeExp.fits %>%
filter(estimate <0))
gap.lifeExp.fits %>%
arrange(estimate) %>%
slice(1:3)
gap.lifeExp.fits %>%
arrange(estimate) %>%
slice(1:3)
(gap.lifeExp.fits %>%
filter(term= I(year - offset)) %>%
filter(estimate <0))
(gap.lifeExp.fits %>%
filter(term== I(year - offset)) %>%
filter(estimate <0))
(gap.lifeExp.fits %>%
filter(term== "I(year - offset)") %>%
filter(estimate <0))
(gap.lifeExp.fits %>%
filter(term== "I(year - offset)") %>%
filter(estimate <0) %>%
arrange(estimate))
gap.lifeExp.fits %>%
filter(term== "I(year - offset)") %>%
arrange(estimate) %>%
slice(1:3)
gap.lifeExp.fits %>%
filter(term== "I(year - offset)") %>%
filter(estimate >0) %>%
arrange(estimate) %>%
slice(1:3)
gap.lifeExp.fits %>%
filter(term== "I(year - offset)") %>%
filter(estimate >0) %>%
arrange(desc(estimate)) %>%
slice(1:3)
View(gap.lifeExp.fits)
View(gap.reordered.nested)
gap.reordered.nested %>%
mutate(fit.lm = map(data, lm_fit)) %>%
unnest(data) %>%
unnest(fit.lm)
gap.reordered.nested %>%
mutate(fit.lm = map(data, lm_fit)) %>%
unnest(data, fit.lm)
# Run the linear function on each country
gap.lifeExp.fits <- gap.reordered.nested %>%
mutate(fit.lm = map(data, lm_fit)) %>%
select(continent, country, fit.lm) %>%
unnest(fit.lm)
## Find the best and worst countries in continents
# Countries with life expectancy that has declined over time
(gap.lifeExp.fits %>%
filter(term== "I(year - offset)") %>%
filter(estimate <0) %>%
arrange(estimate))
# Top 3 countries with life expectancy that has increased over time
(gap.lifeExp.fits %>%
filter(term== "I(year - offset)") %>%
filter(estimate >0) %>%
arrange(desc(estimate)) %>%
slice(1:3))
View(gap.lifeExp.fits)
write.table(gap.lifeExp.fits, file="/Users/katejohnson/Google Drive/Classes/STAT545.547/STAT545-hw-Johnson-Kate/STAT545-hw-Johnson-Kate_Oct5/hw07-Automating_Pipelines/gap.lifeExp.fits.tsv")
gapminder <- read.delim("/Users/katejohnson/Google Drive/Classes/STAT545.547/STAT545-hw-Johnson-Kate/STAT545-hw-Johnson-Kate_Oct5/hw07-Automating_Pipelines/gapminder.tsv")
gapminder.lm <- write.table(file="/Users/katejohnson/Google Drive/Classes/STAT545.547/STAT545-hw-Johnson-Kate/STAT545-hw-Johnson-Kate_Oct5/hw07-Automating_Pipelines/gap.lifeExp.fits.tsv")
gapminder.lm <- read.table(file="/Users/katejohnson/Google Drive/Classes/STAT545.547/STAT545-hw-Johnson-Kate/STAT545-hw-Johnson-Kate_Oct5/hw07-Automating_Pipelines/gap.lifeExp.fits.tsv")
View(gapminder.lm)
View(gapminder)
ggplot(gapminder, aes(x=LifeExp, y=year)) + facet_grid(~ continent)
ggplot(gapminder, aes(x=lifeExp, y=year)) + facet_grid(~ continent)
ggplot(gapminder, aes(x=lifeExp, y=year)) +
facet_grid(~ continent) +
geom_point()
ggplot(gapminder, aes(x=year, y=lifeExp)) +
facet_grid(~ continent) +
geom_point()
ggplot(gapminder, aes(x=year, y=lifeExp)) +
facet_wrap(~ continent) +
geom_point()
ggplot(gapminder, aes(x=year, y=lifeExp)) +
facet_wrap(~ continent) +
geom_point() +
theme_bw() + xlab("Year") + ylab("Life Expectancy")
ggplot(gapminder, aes(x=year, y=lifeExp)) +
facet_wrap(~ continent) +
geom_point() +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,20))
ggplot(gapminder, aes(x=year, y=lifeExp)) +
facet_wrap(~ continent) +
geom_point() +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
gapminder %>%
filter(continent=="Asia") %>%
ggplot(aes(x=year, y=lifeExp)) +
facet_wrap(~ continent) +
geom_point() +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
gapminder %>%
filter(continent=="Asia") %>%
ggplot(aes(x=year, y=lifeExp)) +
facet_wrap(~ continent) +
geom_point() +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2015,15))
gapminder %>%
filter(continent=="Asia") %>%
ggplot(aes(x=year, y=lifeExp)) +
facet_wrap(~ country) +
geom_point() +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
View(gapminder.lm)
base.Asia <- gapminder %>%
filter(continent=="Asia") %>%
ggplot(aes(x=year, y=lifeExp)) +
facet_wrap(~ country) +
geom_point() +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
base.Asia + geom_abline()
base.Asia + stat_smooth()
View(gapminder.lm)
View(gapminder.lm)
melt(gapminder.lm, id=c("continent","country","term"))
library(reshape2)
melt(gapminder.lm, id=c("continent","country","term"))
elt(gapminder.lm, id=c("continent","country"))
melt(gapminder.lm, id=c("continent","country"))
spread(gapminder.lm, continent, term)
spread(gapminder.lm, country, term)
gapminder.lm %>%
filter(continent=="Asia")
View(gapminder.lm)
gapminder.lm %>%
filter(continent=="Asia") %>%
select(country, term, estimate)
lm.Asia <- gapminder.lm %>%
filter(continent=="Asia") %>%
select(country, term, estimate)
View(lm.Asia)
lm.Asia <- gapminder.lm %>%
filter(continent=="Asia") %>%
select(country, term, estimate) %>%
spread(lm.Asia, country, term)
lm.Asia <- gapminder.lm %>%
filter(continent=="Asia") %>%
select(country, term, estimate) %>%
spread(lm.Asia, country, estimate)
lm.Asia <- gapminder.lm %>%
filter(continent=="Asia") %>%
select(country, term, estimate) %>%
spread(lm.Asia, term, estimate)
lm.Asia <- gapminder.lm %>%
filter(continent=="Asia") %>%
select(country, term, estimate) %>%
spread(lm.Asia, key=term)
lm.Asia <- gapminder.lm %>%
filter(continent=="Asia") %>%
select(country, term, estimate) %>%
gather(data=lm.Asia, key=term)
View(lm.Asia)
lm.Asia <- gapminder.lm %>%
filter(continent=="Asia") %>%
select(country, term, estimate) %>%
gather(term, estimate)
View(lm.Asia)
lm.Asia <- gapminder.lm %>%
filter(continent=="Asia") %>%
select(country, term, estimate) %>%
spread(term, estimate)
View(lm.Asia)
lm.Asia <- gapminder.lm %>%
filter(continent=="Asia") %>%
select(country, term, estimate) %>%
spread(term, estimate) %>%
rename(slope= "I(year - offset)"))
lm.Asia <- gapminder.lm %>%
filter(continent=="Asia") %>%
select(country, term, estimate) %>%
spread(term, estimate) %>%
rename(slope= "I(year - offset)")
View(lm.Asia)
lm.Asia <- gapminder.lm %>%
filter(continent=="Asia") %>%
select(country, term, estimate) %>%
spread(term, estimate) %>%
rename(intercept= "(Intercept)", slope= "I(year - offset)")
View(lm.Asia)
base.Asia + geom_abline(lm.Asia, aes(slope = slope, intercept = intercept)
base.Asia + geom_abline(lm.Asia, aes(slope = slope, intercept = intercept))
lm.Asia <- gapminder.lm %>%
filter(continent=="Asia") %>%
select(country, term, estimate) %>%
spread(term, estimate) %>%
rename(Intercept= "(Intercept)", Slope= "I(year - offset)")
base.Asia + geom_abline(lm.Asia, aes(slope = Slope, intercept = Intercept))
base.Asia
base.Asia <- gapminder %>%
filter(continent=="Asia") %>%
ggplot(aes(x=year, y=lifeExp)) +
facet_wrap(~ country) + geom_abline(data=lm.Asia, aes(slope = Slope, intercept = Intercept)) +
geom_point() +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
base.Asia
base.Asia + geom_abline(lm.Asia, aes(slope = Slope, intercept = Intercept, group=country))
gapminder %>%
filter(continent=="Asia") %>%
ggplot(aes(x=year, y=lifeExp)) +
facet_wrap(~ country) +
geom_point() + geom_abline(lm.Asia) +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
gapminder %>%
filter(continent=="Asia") %>%
ggplot(aes(x=year, y=lifeExp)) +
facet_wrap(~ country) +
geom_point() + geom_abline(lm.Asia, aes(slope = Slope, intercept = Intercept)) +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
lm.Asia <- gapminder.lm %>%
filter(continent=="Asia") %>%
select(country, term, estimate) %>%
spread(term, estimate) %>%
rename(myIntercept= "(Intercept)", mySlope= "I(year - offset)")
base.Asia <- gapminder %>%
filter(continent=="Asia") %>%
ggplot(aes(x=year, y=lifeExp)) +
facet_wrap(~ country) +
geom_point() + geom_abline(lm.Asia, aes(slope = mySlope, intercept = myIntercept)) +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
gapminder %>%
filter(continent=="Asia") %>%
ggplot(aes(x=year, y=lifeExp)) +
facet_wrap(~ country) +
geom_abline(lm.Asia, aes(slope = mySlope, intercept = myIntercept)) +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
gapminder %>%
filter(continent=="Asia") %>%
ggplot(aes(x=year, y=lifeExp)) +
facet_wrap(~ country) +
geom_point() + geom_line(lm.Asia) +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
gapminder %>%
filter(continent=="Asia") %>%
ggplot(aes(x=year, y=lifeExp)) +
facet_wrap(~ country) +
geom_point() + geom_line(aes(data=lm.Asia)) +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
base.Asia <- gapminder %>%
filter(continent=="Asia") %>%
ggplot(aes(x=year, y=lifeExp)) +
facet_wrap(~ country) +
geom_point() +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
base.Asia
base.Asia + geom_abline(lm.Asia, aes(slope = mySlope, intercept = myIntercept, group=country))
base.Asia + geom_abline(lm.Asia, aes(slope = mySlope, intercept = myIntercept))
base.Asia + geom_abline(lm.Asia, aes(slope = mySlope, intercept = myIntercep, by=country))
base.Asia + geom_abline(lm.Asia, aes(slope = mySlope, intercept = myIntercept, by=country))
base.Asia + geom_abline(lm.Asia, aes(slope = mySlope, intercept = myIntercept), by=country)
base.Asia + geom_abline(data=lm.Asia, aes(slope = mySlope, intercept = myIntercept), by=country)
base.Asia + geom_abline(data=lm.Asia, aes(slope = mySlope, intercept = myIntercept), by=lm.Asis$country)
base.Asia + geom_abline(data=lm.Asia, aes(slope = mySlope, intercept = myIntercept), by=lm.Asia$country)
base.Asia + geom_line(lm.Asia)
base.Asia + geom_abline(slope=2, intercept=40)
base.Asia + geom_line(slope=2, intercept=40)
base.Asia + geom_hline(aes(yintercept=40))
base.Asia + geom_abline(aes(slope = mySlope, intercept = myIntercept), data=lm.Asia)
gapminder %>%
filter(continent=="Asia") %>%
ggplot(aes(x=year, y=lifeExp)) +
geom_point() +
geom_abline(aes(slope = mySlope, intercept = myIntercept), data=lm.Asia) +
facet_wrap(~ country) +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
lm.Asia.2 <- filter(country=="Afghanistan")
lm.Asia.2 <- filter(lm.Asia, country=="Afghanistan")
View(lm.Asia.2)
gapminder %>%
filter(continent=="Asia", country=="Afghanistan") %>%
ggplot(aes(x=year, y=lifeExp)) +
geom_point() +
geom_abline(aes(slope = mySlope, intercept = myIntercept), data=lm.Asia.2) +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
gapminder %>%
filter(continent=="Asia", country=="Afghanistan") %>%
ggplot(aes(x=year, y=lifeExp)) +
geom_point() +
geom_abline(aes(mySlope, myIntercept), data=lm.Asia.2) +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
gapminder %>%
filter(continent=="Asia", country=="Afghanistan") %>%
ggplot(aes(x=year, y=lifeExp)) +
geom_point() +
geom_abline(lm.Asia.2, aes(slope = mySlope, intercept = myIntercept)) +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
str(lm.Asia.2)
lm.Asia.2 <- filter(lm.Asia, country=="Afghanistan") %>% select(myIntercept, mySlope)
gapminder %>%
filter(continent=="Asia", country=="Afghanistan") %>%
ggplot(aes(x=year, y=lifeExp)) +
geom_point() +
geom_abline(lm.Asia.2, aes(slope = mySlope, intercept = myIntercept)) +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
gapminder %>%
filter(continent=="Asia", country=="Afghanistan") %>%
ggplot(aes(x=year, y=lifeExp)) +
geom_point() +
geom_abline(data=lm.Asia.2, aes(slope = mySlope, intercept = myIntercept)) +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
gapminder %>%
filter(continent=="Asia", country=="Afghanistan") %>%
ggplot(aes(x=year, y=lifeExp)) +
geom_point() +
geom_abline(slope =2, intercept = 30)) +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
gapminder %>%
filter(continent=="Asia", country=="Afghanistan") %>%
ggplot(aes(x=year, y=lifeExp)) +
geom_point() +
geom_abline(slope =2, intercept = 30) +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
gapminder %>%
filter(continent=="Asia", country=="Afghanistan") %>%
ggplot(aes(x=year, y=lifeExp)) +
geom_point() +
geom_line(slope =2, intercept = 30) +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
gapminder %>%
filter(continent=="Asia", country=="Afghanistan") %>%
ggplot(aes(x=year, y=lifeExp)) +
geom_point() +
geom_abline(slope =2, intercept = 30) +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
gapminder %>%
filter(continent=="Asia", country=="Afghanistan") %>%
ggplot(aes(x=year, y=lifeExp)) +
geom_point() +
geom_abline(slope =2, intercept = 30)
gapminder %>%
filter(continent=="Asia", country=="Afghanistan") %>%
ggplot(aes(x=year, y=lifeExp)) +
geom_point() +
geom_vline(intercept = 30) +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
gapminder %>%
filter(continent=="Asia", country=="Afghanistan") %>%
ggplot(aes(x=year, y=lifeExp)) +
geom_point() +
geom_vline(xintercept = 1990) +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
lm_fit <- function(mydata, offset=1952) {
fit <- lm(lifeExp ~ I(year-offset), data=mydata)
tidy(fit)
}
gapminder %>%
filter(continent=="Asia", country=="Afghanistan") %>%
ggplot(aes(x=year, y=lifeExp)) +
geom_point() +
stat_function(fun=lm_fit) +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
gapminder %>%
filter(continent=="Asia", country=="Afghanistan") %>%
ggplot(aes(x=year, y=lifeExp)) +
geom_point() +
geom_abline(intercept=32) +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
p <- gapminder %>%
filter(continent=="Asia", country=="Afghanistan") %>%
ggplot(aes(x=year, y=lifeExp)) +
geom_point() +
theme_bw() + xlab("Year") + ylab("Life Expectancy") +  scale_x_continuous(breaks=seq(1950,2010,15))
p +  geom_abline(intercept=32)
p +  geom_abline(intercept=50)
p +  geom_abline(intercept=30, col="red")
p +  geom_abline(aes(intercept=30), col="red")
p +  geom_abline(aes(intercept=30, slope=0.5), col="red")
p +  geom_line(aes(intercept=30, slope=0.5), col="red")
p +  geom_abline(intercept=30, slope=0.5)
p <- gapminder %>%
filter(continent=="Asia", country=="Afghanistan") %>%
ggplot(aes(x=year, y=lifeExp)) +
geom_point() +
p +  geom_abline(intercept=30, slope=0.5)
p <- gapminder %>%
filter(continent=="Asia", country=="Afghanistan") %>%
ggplot(aes(x=year, y=lifeExp)) +
geom_point() +
p +  geom_abline(intercept=30, slope=0.5)
p <- gapminder %>%
filter(continent=="Asia", country=="Afghanistan") %>%
ggplot(aes(x=year, y=lifeExp)) +
geom_point() +
p +  geom_abline(intercept=30, slope=0.5)
p <- gapminder %>%
filter(continent=="Asia", country=="Afghanistan") %>%
ggplot(aes(x=year, y=lifeExp)) +
geom_point() +
p +  geom_abline(intercept=30, slope=0.5)
p <- gapminder %>%
filter(continent=="Asia", country=="Afghanistan") %>%
ggplot(aes(x=year, y=lifeExp)) +
geom_point()
p +  geom_abline(intercept=30, slope=0.5)
